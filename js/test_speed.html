<!DOCTYPE html>
<html>
<head><meta charset="utf-8"></head>
<body>

<script src='../data/data03.js'></script>
<script src='bsdf.js'></script>

<script>

function deep_compare(d1, d2) {
    var s1 = JSON.stringify(d1);
    var s2 = JSON.stringify(d2);
    for (var i=0; i<Math.max(s1.length, s2.length); i++) {
          if (s1[i] != s2[i]) {
              var i0 = Math.max(0, i - 10);
              document.write('Dicts are NOT equal:')
              document.write(s1.slice(i0, i0 + 100) + '<br />');
              document.write(s2.slice(i0, i0 + 100) + '<br />');
              return;
          }
    }
    document.write('Hooray, dicts are equal!')
}

window.document.body.onload = function() {
    console.log('document loaded')
    
    window.d = testdata;//JSON.parse(document.getElementById('stuff').innerHTML);
    console.log('parsed test data. starting tests...')
    
    //var t0, t1, t2, r1, r2, d1, d2;
    
    t0 = performance.now();
    r1 = JSON.stringify(d);
    t1 = performance.now() - t0;
    
    t0 = performance.now();
    r2 = bsdf_encode(d);
    t2 = performance.now() - t0;
    
    r = Math.round;
    document.write('encoding: ' + r(t1) + ', ' + r(t2) + ': ' + r(100 * t1/t2) + '%<br />')
    
    
    t0 = performance.now();
    d1 = JSON.parse(r1);
    t1 = performance.now() - t0;
    
    t0 = performance.now();
    d2 = bsdf_decode(r2);
    t2 = performance.now() - t0;
    
    document.write('decoding: ' + r(t1) + ', ' + r(t2) + ': ' + r(100 * t1/t2) + '%<br />')
    
    document.write('<br />');
    deep_compare(d1, d2);

}

</script>

</body>
</html>
